<!doctype HTML>
<html>
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <!--<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136675623-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-136675623-1');
    </script>-->
    
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    </head>
    <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
    <script src="https://rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        var isTargetFound = false;
        var cuenta =0;
            AFRAME.registerComponent("markerhandler",{
                    init:function() {
                        console.log('markerhandler-init');
    
                       markerObj = document.querySelector('a-marker');
                       markerObj.hidden = true;

                    },
    
                    tick:function() {
    
                        if (markerObj != null)
                            {
                                if (markerObj.object3D.visible == true) {
                                    
                                  if (isTargetFound)
                                    return;
    
                                  isTargetFound = true;
                                  console.log ("marker visible");
                                  

                                  cuenta++;
                                  if(cuenta == 1)
                                  {
                                    document.getElementById("plane").emit("planeout");
                                    document.getElementById("qr").emit("qrout");
                                    document.getElementById("loaderPlane").emit("loaderRot");
                                    window.setTimeout(function(e)
                                    {
                                        document.getElementById("loader").emit("loaderPos");
                                        document.getElementById("logiflexPlane").emit("logiflexOpa");
                                        document.getElementById("transPlane").emit("transOpa");
                                    },2000);
                                    window.setTimeout(function(e)
                                    {
                                        document.getElementById("circulos").emit("circulosScale");
                                    },3000);
                                    window.setTimeout(function(e)
                                    {
                                        document.getElementById("c1").emit("reduce");
                                        document.getElementById("c2").emit("reduce");
                                        document.getElementById("c3").emit("reduce");
                                        document.getElementById("caja").emit("cajaCrece");
                                        valida=1;
                                    },7000);
                                  }
                                  
                                  
                                }
                                else {
                                    
                                  if (!isTargetFound)
                                    return;
    
                                  isTargetFound = false;
                                console.log ("marker invisible");
                                }
                              }
                      }
                    });
        </script>
    <body id="cuerpo" style='margin : 0px; overflow: hidden;'>
        <!-- we add detectionMode and matrixCodeType to tell AR.js to recognize barcode markers -->
        <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3; patternRatio:0.8;'>
                <a-entity light="type: ambient; color: #BBB"></a-entity>
                <a-entity light="type: directional; color: #FFF; intensity: .6" position="-0.5 1 1"></a-entity>

            <a-marker markerhandler emitevents="true" type='pattern' url='pattern-d.patt'>

                <a-entity id="loader" rotation="-90 0 0">
                   <a-plane id="loaderPlane" position="0 0 0" width=".5" height=".5" rotation="0 0 360" material="src:images/loader.png" opacity=".99">
                        <a-animation
                            attribute="rotation"
                            begin="loaderRot"
                            dur="700"
                            to="0 0 0"
                            easing="linear"
                            repeat="3"
                        ></a-animation>
                        <a-animation
                            attribute="rotation"
                            begin="4000"
                            dur="900"
                            to="0 0 0"
                            easing="linear"
                            repeat="indefinite"
                        ></a-animation>
                    </a-plane> 
                    <a-animation
                        attribute="position"
                        begin="loaderPos"
                        dur="1000"
                        to="-1 0 -1"
                        
                    ></a-animation>
                </a-entity>

                <a-entity id="logiflex" rotation="-90 0 0" position="0 0 -1.125">
                    <a-plane id="logiflexPlane" width="1.2" height=".25" rotation="0 0 360" material="src:images/logiflex.png" opacity="0">
                            <a-animation
                                attribute="opacity"
                                begin="logiflexOpa"
                                dur="1000"
                                to=".99"
                                easing="linear"
                            ></a-animation>
                        </a-plane> 
                </a-entity>
                <a-entity id="trans" rotation="-90 0 0" position="0 0 -.875">
                        <a-plane id="transPlane" width="1" height=".125" rotation="0 0 360" material="src:images/trans.png" opacity="0">
                                <a-animation
                                    attribute="opacity"
                                    begin="transOpa"
                                    dur="1000"
                                    to=".99"
                                    easing="linear"
                                ></a-animation>
                            </a-plane> 
                </a-entity>

                <a-entity id="circulos" scale=".001 .001 .001">
                    <a-entity id="c1" position="-1 0 0">
                        <a-entity>
                            <a-cylinder position="0 0 0" radius=".4" height=".001" color="#f28423"></a-cylinder>
                            <a-entity>
                            <a-ring position="0 0 0" rotation="-90 0 0" radius-inner=".44" radius-outer=".47" material="src:images/punteado.png" opacity=".9"></a-ring>
                            <a-animation
                                attribute="rotation"
                                dur="6000"
                                to="0 360 0"
                                repeat="indefinite"
                                easing="linear"
                            ></a-animation> 
                            </a-entity>
                        </a-entity>
                        <a-text value="Tecnologia" position="-.3 .1 0" scale=".6 .6 .6" rotation="-90 0 0"></a-text>
                    <a-animation
                        attribute="scale"
                        begin="reduce"
                        dur="1000"
                        to=".0001 .00001 .00001"
                        easing="linear"
                    ></a-animation>
                    </a-entity>

                    <a-entity id="c2">
                        <a-entity>
                            <a-cylinder position="0 0 0" radius=".4" height=".001" color="#f28423"></a-cylinder>
                            <a-entity>
                            <a-ring position="0 0 0" rotation="-90 0 0" radius-inner=".44" radius-outer=".47" material="src:images/punteado.png" opacity=".9"></a-ring>
                            <a-animation
                                attribute="rotation"
                                dur="6000"
                                to="0 360 0"
                                repeat="indefinite"
                                easing="linear"
                            ></a-animation> 
                            </a-entity>
                        </a-entity>
                        <a-text value="Proceso" position="-.3 .1 0" scale=".6 .6 .6" rotation="-90 0 0"></a-text>
                    <a-animation
                        attribute="scale"
                        begin="reduce"
                        dur="1000"
                        to=".0001 .00001 .00001"
                        easing="linear"
                    ></a-animation>
                    </a-entity>

                    <a-entity id="c3" position="1 0 0">
                            <a-entity>
                                <a-cylinder position="0 0 0" radius=".4" height=".001" color="#f28423"></a-cylinder>
                                <a-entity>
                                <a-ring position="0 0 0" rotation="-90 0 0" radius-inner=".44" radius-outer=".47" material="src:images/punteado.png" opacity=".9"></a-ring>
                                <a-animation
                                    attribute="rotation"
                                    dur="6000"
                                    to="0 360 0"
                                    repeat="indefinite"
                                    easing="linear"
                                ></a-animation> 
                                </a-entity>
                            </a-entity>
                            <a-text value="Talento" position="-.3 .1 0" scale=".6 .6 .6" rotation="-90 0 0"></a-text>
                    <a-animation
                        attribute="scale"
                        begin="reduce"
                        dur="1000"
                        to=".0001 .00001 .00001"
                        easing="linear"
                    ></a-animation>
                    </a-entity>
                    <a-animation
                        attribute="scale"
                        begin="circulosScale"
                        dur="1000"
                        to="1 1 1"
                        easing="linear"
                    ></a-animation>
                </a-entity>
                
                <a-box id="caja" position="0 .25 0" scale=".00005 .00005 .00005" material="src:images/wp.png">
                    <a-animation
                        attribute="rotation"
                        dur="10000"
                        to="0 360 360"
                        repeat="indefinite"
                        easing="linear"
                    ></a-animation>
                    <a-animation
                        attribute="scale"
                        begin="cajaCrece"
                        dur="1000"
                        to=".5 .5 .5"
                        easing="linear"
                    ></a-animation>
                </a-box>
                

                
            </a-marker>
    
                <a-plane  position="-.01 -.03 -.1" width=".02" height=".006" opacity=".3"
                material="src: images/powvector.png"></a-plane>
                <a-plane id="plane" position="0 0 -.098" width="2" height="2" material="color:black;" opacity=".4">
                    <a-animation
                        attribute="opacity"
                        begin="planeout"
                        dur="1000"
                        to="0"
                    ></a-animation>
                </a-plane>
                <a-plane id="qr" position="0 0 -.097" width=".02" height=".02" material="src:images/enfoca.png;" opacity=".9">
                    <a-animation
                        attribute="opacity"
                        begin="qrout"
                        dur="1000"
                        to="0"
                    ></a-animation>
                </a-plane>

                <a-entity camera></a-entity>
            </a-scene>
            
        </body>
    
        <script>
            var valida=0;
            var boxEl6 = document.getElementById('cuerpo');
            boxEl6.addEventListener('click', function () {
                //boxEl.setAttribute('scale', {x: 2, y: 2, z: 2});
                if(valida == 1)
                {
                    window.open("http://logiflex.pe/");
                }
                
            });
        </script>
</html>