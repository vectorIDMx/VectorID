<!doctype HTML>
<html>
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <!--<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136675623-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-136675623-1');
    </script>-->
    
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    </head>
    <script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
    <script src="https://rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        var isTargetFound = false;
        var interacted = false;
        var dino = null;
        var cuenta =0;
            AFRAME.registerComponent("markerhandler",{
                    init:function() {
                        console.log('markerhandler-init');
    
                       markerObj = document.querySelector('a-marker');
                       markerObj.hidden = true;

                    },
    
                    tick:function() {
    
                        if (markerObj != null)
                            {
                                if (markerObj.object3D.visible == true) {
                                    
                                  if (isTargetFound)
                                    return;
    
                                  isTargetFound = true;
                                  console.log ("marker visible");
                                  cuenta++;
                                  if(cuenta == 1)
                                  {
                                    //document.getElementById("ufo").emit("ufoin");
                                    document.getElementById("plane").emit("planeout");
                                    document.getElementById("qr").emit("qrout");
                                    document.getElementById("space").emit("anSpace"); 
                                    window.setTimeout(function(e)
                                    {
                                        document.getElementById("paquete").emit("anPaquete");
                                    },10000);

                                    window.setTimeout(function(e){
                                        //document.getElementById("cone").emit("conein");
                                    },4000);
                                  }
                                  
                                  
                                }
                                else {
                                    
                                  if (!isTargetFound)
                                    return;
    
                                  isTargetFound = false;
                                console.log ("marker invisible");
                                }
                              }
                      }
                    });
        </script>
    <body style='margin : 0px; overflow: hidden;'>
        <!-- we add detectionMode and matrixCodeType to tell AR.js to recognize barcode markers -->
        <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3; patternRatio:0.8;'>
                <a-entity light="type: ambient; color: #FFF"></a-entity>
                <a-entity light="type: directional; color: #FFF; intensity: .6" position="-0.5 1 1"></a-entity>

                <a-entity position="0 0 -.1" scale=".03 .03 .03">
                        

                    
                </a-entity>
                
                
            
            <a-marker markerhandler emitevents="true" cursor="fuse: false; rayOrigin: mouse" type='pattern' url='pattern-pizza-flyer.patt'>

                    <a-entity id="logo" position="0 1 -1" scale="1 1 1" rotation="0 0 0">
                            <a-sphere position="0 1 0" radius=".125" material="color: yellow;" ></a-sphere>    
                            <a-entity>
                                <a-ring position="0 1 0" radius-inner=".15" radius-outer=".2" rotation="-80 0 0" material="color:red;" opacity=".5" ></a-ring>
                                <a-ring position="0 1 0" radius-inner=".2" radius-outer=".25" rotation="-80 0 0" material="color:yellow;" opacity=".5"></a-ring>
        
                                <a-ring position="0 .99 0" radius-inner=".15" radius-outer=".2" rotation="100 0 0" material="color:red;" opacity=".5"></a-ring>
                                <a-ring position="0 .99 0" radius-inner=".2" radius-outer=".25" rotation="100 0 0" material="color:yellow;" opacity=".5"></a-ring>
                                <a-animation
                                attribute="rotation"
                                dur="3000"
                                to="0 360 0"
                                repeat="indefinite"
                                easing="linear"
                                ></a-animation>
                            </a-entity>
                            <a-entity>
                                <a-plane position="0 .7 0" rotation="0 0 0" width="1.18" height=".18" material="src:images/logopp.png" opacity=".7"></a-plane>
                                <a-plane position="0 .7 -.1" rotation="0 180 0" width="1.18" height=".18" material="src:images/logopp.png" opacity=".7"></a-plane>
                                <a-animation
                                attribute="rotation"
                                begin="7000"
                                dur="1000"
                                to="0 360 0"
                                repeat="indefinite"
                                ></a-animation>
                            </a-entity>
                        </a-entity>

                <a-sphere position="-.5 .5 2" radius=".25" material="src:images/t1.jpg">
                    <a-animation
                    attribute="rotation"
                    dur="10000"
                    to="0 360 0"
                    easing="linear"
                    repeat="indefinite"
                    >
                    </a-animation>
                    <a-animation
                    attribute="position"
                    dur="5000"
                    to="-.5 1.5 2"
                    repeat="indefinite"
                    direction="alternate"
                    >
                    </a-animation>
                </a-sphere>

                <a-sphere position="1.5 1.5 -.5" radius=".3" material="src:images/t4.jpg">
                    <a-animation
                    attribute="rotation"
                    dur="10000"
                    to="0 360 0"
                    easing="linear"
                    repeat="indefinite"
                    >
                    </a-animation>
                    <a-animation
                    attribute="position"
                    dur="5000"
                    to="1.5 .5 -.5"
                    repeat="indefinite"
                    direction="alternate"
                    >
                    </a-animation>
                </a-sphere>
                <a-entity position="-1 .5 .4">
                    <a-sphere radius=".35" material="src:images/t3.jpg">
                    <a-animation
                    attribute="rotation"
                    dur="10000"
                    to="0 360 0"
                    easing="linear"
                    repeat="indefinite"
                    >
                    </a-animation>
                </a-sphere>
                <a-entity >
                        <a-ring position="0 0 0" radius-inner=".4" radius-outer=".5" rotation="-80 0 0" material="color:#A9FCFC;" opacity=".5" ></a-ring>
                        <a-ring position="0 0 0" radius-inner=".5" radius-outer=".6" rotation="-80 0 0" material="color:#5FF9FA;" opacity=".5"></a-ring>

                        <a-ring position="0 -.01 0" radius-inner=".4" radius-outer=".5" rotation="100 0 0" material="color:#A9FCFC;" opacity=".5"></a-ring>
                        <a-ring position="0 -.01 0" radius-inner=".5" radius-outer=".6" rotation="100 0 0" material="color:#5FF9FA;" opacity=".5"></a-ring>
                        <a-animation
                        attribute="rotation"
                        dur="3000"
                        to="0 360 0"
                        repeat="indefinite"
                        easing="linear"
                        ></a-animation>
                    </a-entity>
                    <a-animation
                    attribute="position"
                    dur="7000"
                    to="-1 1.5 .4"
                    repeat="indefinite"
                    direction="alternate"
                    >
                    </a-animation>
                </a-entity>
                <a-entity rotation="0 0 0">
                    <a-sphere position="2 .7 0" radius=".15" material="color:red;">
                    <a-animation
                    attribute="position"
                    dur="3000"
                    to="2 2 0"
                    repeat="indefinite"
                    easing="linear"
                    direction="alternate"
                    ></a-animation>
                </a-sphere>
                <a-animation
                    attribute="rotation"
                    dur="8000"
                    to="0 360 0"
                    repeat="indefinite"
                    easing="linear"
                    ></a-animation>
                </a-entity>
                
                <a-gltf-model id="space" src="modelos/spaceship/scene.gltf" position="-.2 -3.1 0" rotation="0 -90 -90" scale=".04 .04 .04">
                    <a-animation
                    attribute="position"
                    begin="anSpace"
                    dur="10000"
                    to="-.2 1 0"
                    ></a-animation>
                </a-gltf-model>
                <a-plane position="0 0 1" rotation="-90 0 0" width="5" height="5" material="src:images/nada.png"></a-plane>
                <a-plane id="paquete" position="1.2 1.2 0.5" rotation="0 0 0" width=".00001" height="1" material="src:images/paquete.png">
                    <a-animation
                    attribute="width"
                    begin="anPaquete"
                    dur="1000"
                    to="2"
                    ></a-animation>
                </a-plane>
                
            </a-marker>
    
                <a-plane  position="-.01 -.03 -.1" width=".02" height=".006" opacity=".3"
                material="src: images/powvector.png"></a-plane>
                <a-plane id="plane" position="0 0 -.098" width="2" height="2" material="color:black;" opacity=".4">
                    <a-animation
                        attribute="opacity"
                        begin="planeout"
                        dur="1000"
                        to="0"
                    ></a-animation>
                </a-plane>
                <a-plane id="qr" position="0 0 -.097" width=".02" height=".02" material="src:images/enfoca.png;" opacity=".9">
                    <a-animation
                        attribute="opacity"
                        begin="qrout"
                        dur="1000"
                        to="0"
                    ></a-animation>
                </a-plane>

                <a-entity camera></a-entity>
            </a-scene>
            
        </body>
    
        <script>

        </script>
</html>